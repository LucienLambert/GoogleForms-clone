
<app-nav-bar [title]="form?.title" [backButtonVisible]="backButtonVisible" [isEditVisible]="!instanceInProgress" 
             [isAnalyseVisible]="instanceInProgress" (editEvent)="editForm()" (AnalyseEvent)="analyse()"
             [delFormVisible]="delFormButton"
             (delFormEvent)="delForm()"
             [previousUrl]="previousUrl"
             class="toolbar-actions">
    <button *ngIf="user?.role === 2 || user?.id === form?.ownerId"
        mat-icon-button shareButton>
        <mat-icon shareButton (click)="shareButtonAction()">share</mat-icon>
    </button>
</app-nav-bar>

<div class="manage-container">
    <div class="form-container">
        <div class="form-item">
            <div class="form-label">Title :</div>
            <div class="form-value">{{ form?.title }}</div>
        </div>
        <div class="form-item">
            <div class="form-label">Description :</div>
            <div class="form-value">{{ form?.description || 'No description'}}</div>
        </div>
        <div class="form-item">
            <div class="form-label">Owner :</div>
            <div class="form-value">{{ (form?.owner?.firstName && form?.owner?.lastName) ? (form?.owner?.firstName + ' ' + form?.owner?.lastName) 
                : form?.owner?.email }}
            </div>

        </div>
        <div class="form-item">
            <div class="form-label">Public : </div>
            <mat-slide-toggle
                [disabled]="!(user?.role === 2 || form?.owner?.id === user?.id)"
                [checked]="form?.isPublic"
                (change)="toggleIsPublic($event)">
            </mat-slide-toggle>
        </div>
        <div *ngIf="listQuestion.length > 0; else noQuestions">
            <h2 class="mb-4">Questions</h2>
            <div *ngFor="let question of listQuestion let i = index">
                <app-form-question-card
                    [question]="question"
                    [indexQuestion]="i"
                    [sizeListQuestion]="listQuestion.length -1"
                    (moveDownEvent)="moveDown($event)"
                    (moveUpEvent)="moveUp($event)"
                    (editQuestionEvent)="editQuestion($event)"
                    (delQuestionEvent)="delQuestion($event)"
                    [instanceInProgress]="instanceInProgress">
                </app-form-question-card>
            </div>
        </div>
    </div>

    

    <ng-template #noQuestions>
        <h1 style="text-align: center">No Question</h1>
    </ng-template>
    <div>
        <mat-card-actions *ngIf="!instanceInProgress">
            <button mat-raised-button color="primary" (click)="addQuestion()">Add Question</button>
        </mat-card-actions>
    </div>
</div>
